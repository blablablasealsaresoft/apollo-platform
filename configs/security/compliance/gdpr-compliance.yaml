# GDPR Compliance Configuration for Apollo Platform
# General Data Protection Regulation (EU) 2016/679
# Law Enforcement Directive (LED) 2016/680 considerations

gdpr_compliance:
  enabled: true
  applicable: true
  led_exemptions: true  # Law Enforcement Directive exemptions apply

  # GDPR Principles (Article 5)
  principles:
    # Lawfulness, fairness and transparency
    lawfulness:
      legal_basis: law_enforcement_purposes
      directive: led_2016_680
      transparency: limited  # LED exemption

    # Purpose limitation
    purpose_limitation:
      specified: criminal_investigation
      explicit: true
      legitimate: law_enforcement
      further_processing: compatible_only

    # Data minimization
    data_minimization:
      adequate: true
      relevant: true
      limited_to_necessary: true
      periodic_review: quarterly

    # Accuracy
    accuracy:
      accurate: required
      up_to_date: maintained
      rectification: prompt
      erasure: when_inaccurate

    # Storage limitation
    storage_limitation:
      time_limited: true
      retention_policy: documented
      periodic_review: annual
      archival_procedures: defined

    # Integrity and confidentiality
    integrity_confidentiality:
      security_measures: comprehensive
      encryption: mandatory
      access_controls: strict
      audit_logging: complete

    # Accountability
    accountability:
      demonstrate_compliance: true
      documentation: comprehensive
      dpo_appointed: true

  # Data Subject Rights (with LED exemptions)
  data_subject_rights:
    # Right of access (Article 15)
    right_to_access:
      enabled: limited  # LED exemption
      response_time: 30d
      exemptions:
        - ongoing_investigation
        - national_security
        - public_safety

    # Right to rectification (Article 16)
    right_to_rectification:
      enabled: limited
      response_time: 30d
      verification_required: true

    # Right to erasure (Article 17)
    right_to_erasure:
      enabled: limited  # LED exemption
      exemptions:
        - legal_obligation
        - public_interest
        - evidence_preservation

    # Right to restriction (Article 18)
    right_to_restriction:
      enabled: limited
      circumstances: defined
      notification: required

    # Right to data portability (Article 20)
    right_to_data_portability:
      enabled: false  # Not applicable to LE

    # Right to object (Article 21)
    right_to_object:
      enabled: limited
      grounds: legitimate_interests
      override: public_interest

    # Automated decision-making (Article 22)
    automated_decisions:
      notification: required
      human_intervention: available
      explanation: provided

  # Data Protection by Design and Default (Article 25)
  data_protection_design:
    # Privacy by design
    privacy_by_design:
      implemented: true
      measures:
        - pseudonymization
        - encryption
        - access_controls
        - data_minimization

    # Privacy by default
    privacy_by_default:
      default_settings: privacy_protective
      minimal_data: true
      limited_access: true
      limited_retention: true

  # Data Processing Records (Article 30)
  processing_records:
    maintained: true

    information_included:
      - controller_details
      - processing_purposes
      - data_categories
      - recipient_categories
      - international_transfers
      - retention_periods
      - security_measures

    review_frequency: quarterly

  # Data Protection Officer (Article 37-39)
  data_protection_officer:
    appointed: true
    contact: ${DPO_EMAIL}
    responsibilities:
      - monitor_compliance
      - advise_on_obligations
      - cooperate_with_authority
      - contact_point

  # Security of Processing (Article 32)
  security_measures:
    # Technical measures
    technical:
      - encryption_at_rest
      - encryption_in_transit
      - pseudonymization
      - access_controls
      - mfa_authentication
      - secure_key_management

    # Organizational measures
    organizational:
      - security_policies
      - staff_training
      - access_management
      - incident_response
      - business_continuity

    # Regular testing
    testing:
      frequency: quarterly
      penetration_testing: annual
      vulnerability_scanning: monthly

  # Personal Data Breach (Article 33-34)
  data_breach:
    # Notification to supervisory authority
    authority_notification:
      timeframe: 72h
      authority: ${SUPERVISORY_AUTHORITY}
      information_required:
        - nature_of_breach
        - data_categories
        - affected_individuals
        - consequences
        - measures_taken

    # Communication to data subjects
    subject_notification:
      when_required: high_risk
      timeframe: without_undue_delay
      exemptions:
        - technical_protection_measures
        - subsequent_measures
        - disproportionate_effort

    # Breach documentation
    documentation:
      all_breaches: logged
      facts: recorded
      effects: assessed
      remedial_action: documented

  # Data Protection Impact Assessment (Article 35)
  dpia:
    required_for:
      - systematic_monitoring
      - large_scale_processing
      - sensitive_data
      - new_technologies

    process:
      - description_of_processing
      - necessity_assessment
      - risk_assessment
      - mitigation_measures
      - dpo_consultation

    review_frequency: annual

  # International Data Transfers (Articles 44-50)
  international_transfers:
    # Transfer mechanisms
    mechanisms:
      - adequacy_decision
      - standard_contractual_clauses
      - binding_corporate_rules
      - derogations

    # Specific situations
    derogations:
      - public_interest
      - legal_claims
      - vital_interests

    # Documentation
    documentation: required

  # Third-Party Processing (Articles 28-29)
  third_party_processing:
    # Processor agreements
    processor_agreements:
      required: true
      provisions:
        - processing_instructions
        - confidentiality
        - security_measures
        - sub_processor_authorization
        - assistance_obligations
        - deletion_return

    # Sub-processors
    sub_processors:
      authorization: required
      notification: mandatory
      same_obligations: enforced

  # Data Retention
  data_retention:
    # Retention periods
    periods:
      active_investigations: 7y
      closed_investigations: 20y
      supporting_documents: 7y
      audit_logs: 7y

    # Retention review
    review:
      frequency: annual
      criteria: necessity_and_proportionality

    # Deletion procedures
    deletion:
      secure_deletion: required
      verification: documented

  # Consent Management
  consent:
    # Consent requirements (limited applicability in LE)
    applicable: limited

    requirements:
      - freely_given
      - specific
      - informed
      - unambiguous
      - withdrawable

    # Consent records
    records:
      maintained: true
      information: comprehensive

  # Compliance Monitoring
  monitoring:
    # Internal monitoring
    internal:
      frequency: monthly
      responsibility: dpo
      reporting: management

    # External audits
    external:
      frequency: annual
      auditor: independent
      certification: iso_27701

  # Training and Awareness
  training:
    # Staff training
    staff:
      frequency: annual
      topics:
        - gdpr_principles
        - data_subject_rights
        - security_measures
        - breach_response
        - led_exemptions

    # Specialized training
    specialized:
      dpo: continuous
      it_security: quarterly
      management: annual

  # Documentation and Policies
  documentation:
    policies:
      - data_protection_policy
      - data_retention_policy
      - data_breach_policy
      - privacy_policy
      - cookie_policy

    procedures:
      - subject_access_requests
      - data_breach_response
      - dpia_procedures
      - vendor_management

  # Supervisory Authority
  supervisory_authority:
    authority: ${SUPERVISORY_AUTHORITY}
    registration: required
    reporting: annual
    cooperation: mandatory
