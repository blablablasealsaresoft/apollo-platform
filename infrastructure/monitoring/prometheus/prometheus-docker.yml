# Prometheus Configuration for Apollo Platform - Docker Compose
# Use this for local development with docker-compose

global:
  scrape_interval: 15s
  evaluation_interval: 15s
  external_labels:
    cluster: 'apollo-local'
    environment: 'development'

# Alertmanager configuration (optional for local dev)
alerting:
  alertmanagers:
    - static_configs:
        - targets: []

# Rule files (optional for local dev)
rule_files: []

# Scrape configurations for Docker Compose services
scrape_configs:
  # Prometheus self-monitoring
  - job_name: 'prometheus'
    static_configs:
      - targets: ['localhost:9090']

  # PostgreSQL metrics (requires postgres_exporter sidecar)
  - job_name: 'postgresql'
    static_configs:
      - targets: ['postgresql:5432']
        labels:
          service: 'postgresql'
          environment: 'development'

  # Redis metrics
  - job_name: 'redis'
    static_configs:
      - targets: ['redis:6379']
        labels:
          service: 'redis'
          environment: 'development'

  # Elasticsearch metrics
  - job_name: 'elasticsearch'
    metrics_path: '/_prometheus/metrics'
    static_configs:
      - targets: ['elasticsearch:9200']
        labels:
          service: 'elasticsearch'
          environment: 'development'

  # RabbitMQ metrics
  - job_name: 'rabbitmq'
    static_configs:
      - targets: ['rabbitmq:15692']
        labels:
          service: 'rabbitmq'
          environment: 'development'

  # Neo4j metrics
  - job_name: 'neo4j'
    metrics_path: '/metrics'
    static_configs:
      - targets: ['neo4j:2004']
        labels:
          service: 'neo4j'
          environment: 'development'

  # Apollo Services (when running with custom Dockerfiles)
  - job_name: 'apollo-api-gateway'
    static_configs:
      - targets: ['api-gateway:3000']
        labels:
          service: 'api-gateway'

  - job_name: 'apollo-authentication'
    static_configs:
      - targets: ['auth-service:3001']
        labels:
          service: 'authentication'

  - job_name: 'apollo-user-management'
    static_configs:
      - targets: ['user-service:3002']
        labels:
          service: 'user-management'

  - job_name: 'apollo-operations'
    static_configs:
      - targets: ['operations-service:3003']
        labels:
          service: 'operations'

  - job_name: 'apollo-intelligence'
    static_configs:
      - targets: ['intelligence-service:3004']
        labels:
          service: 'intelligence'

  - job_name: 'apollo-notifications'
    static_configs:
      - targets: ['notifications-service:3005']
        labels:
          service: 'notifications'

  - job_name: 'apollo-analytics'
    static_configs:
      - targets: ['analytics-service:3006']
        labels:
          service: 'analytics'

  - job_name: 'apollo-search'
    static_configs:
      - targets: ['search-service:3007']
        labels:
          service: 'search'

  - job_name: 'apollo-bugtrace-ai'
    static_configs:
      - targets: ['bugtrace-ai-dev:3000']
        labels:
          service: 'bugtrace-ai'
