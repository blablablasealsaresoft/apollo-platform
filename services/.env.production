# Apollo Platform - Production Backend Services Configuration
# SECURITY WARNING: This file contains sensitive configuration
# Never commit actual secrets to version control
# Use environment variables or secret management tools in production

# ============================================
# ENVIRONMENT
# ============================================
NODE_ENV=production

# ============================================
# SERVICE PORTS
# ============================================
API_GATEWAY_PORT=3000
AUTH_SERVICE_PORT=3001
USER_SERVICE_PORT=3002
OPERATIONS_SERVICE_PORT=3003
INTELLIGENCE_SERVICE_PORT=3004
NOTIFICATIONS_SERVICE_PORT=3005
ANALYTICS_SERVICE_PORT=3006
SEARCH_SERVICE_PORT=3007

# ============================================
# DATABASE CONFIGURATION
# REQUIRED: Set these via environment variables or secret manager
# ============================================
# PostgreSQL - Primary Database
DB_HOST=${DB_HOST:?Database host is required}
DB_PORT=${DB_PORT:-5432}
DB_NAME=${DB_NAME:?Database name is required}
DB_USER=${DB_USER:?Database user is required}
DB_PASSWORD=${DB_PASSWORD:?Database password is required}
DB_SSL_MODE=require
DB_POOL_MIN=5
DB_POOL_MAX=20
DB_CONNECTION_TIMEOUT=10000

# ============================================
# REDIS CONFIGURATION
# ============================================
REDIS_HOST=${REDIS_HOST:?Redis host is required}
REDIS_PORT=${REDIS_PORT:-6379}
REDIS_PASSWORD=${REDIS_PASSWORD:?Redis password is required}
REDIS_TLS_ENABLED=true
REDIS_DB=0

# ============================================
# JWT CONFIGURATION
# REQUIRED: Use strong, unique secrets in production
# ============================================
JWT_SECRET=${JWT_SECRET:?JWT secret is required (min 64 characters)}
JWT_ACCESS_EXPIRATION=15m
JWT_REFRESH_EXPIRATION=7d
JWT_ISSUER=apollo-platform
JWT_AUDIENCE=apollo-services

# ============================================
# OAUTH PROVIDERS (Optional)
# ============================================
GOOGLE_CLIENT_ID=${GOOGLE_CLIENT_ID:-}
GOOGLE_CLIENT_SECRET=${GOOGLE_CLIENT_SECRET:-}
MICROSOFT_CLIENT_ID=${MICROSOFT_CLIENT_ID:-}
MICROSOFT_CLIENT_SECRET=${MICROSOFT_CLIENT_SECRET:-}
GITHUB_CLIENT_ID=${GITHUB_CLIENT_ID:-}
GITHUB_CLIENT_SECRET=${GITHUB_CLIENT_SECRET:-}

# ============================================
# EMAIL CONFIGURATION
# ============================================
SMTP_HOST=${SMTP_HOST:-}
SMTP_PORT=${SMTP_PORT:-587}
SMTP_USER=${SMTP_USER:-}
SMTP_PASSWORD=${SMTP_PASSWORD:-}
SMTP_FROM=noreply@apollo-platform.com
SMTP_TLS_ENABLED=true

# ============================================
# ELASTICSEARCH
# ============================================
ELASTICSEARCH_NODE=${ELASTICSEARCH_NODE:?Elasticsearch node URL is required}
ELASTICSEARCH_USERNAME=${ELASTICSEARCH_USERNAME:-}
ELASTICSEARCH_PASSWORD=${ELASTICSEARCH_PASSWORD:-}
ELASTICSEARCH_SSL_ENABLED=true

# ============================================
# RATE LIMITING
# ============================================
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_SKIP_SUCCESSFUL_REQUESTS=false

# ============================================
# CORS CONFIGURATION
# IMPORTANT: Restrict to specific origins in production
# ============================================
CORS_ORIGIN=${CORS_ORIGIN:?CORS origin must be explicitly set}
CORS_CREDENTIALS=true
CORS_METHODS=GET,HEAD,PUT,PATCH,POST,DELETE
CORS_ALLOWED_HEADERS=Content-Type,Authorization,X-Request-ID

# ============================================
# SECURITY SETTINGS
# ============================================
# Session security
SESSION_SECRET=${SESSION_SECRET:?Session secret is required}
COOKIE_SECURE=true
COOKIE_SAME_SITE=strict

# Content Security Policy
CSP_ENABLED=true
HSTS_ENABLED=true
HSTS_MAX_AGE=31536000

# API Key settings
API_KEY_HEADER=X-API-Key
API_KEY_HASH_ROUNDS=12

# ============================================
# SERVICE URLS
# ============================================
FRONTEND_URL=${FRONTEND_URL:?Frontend URL is required}
API_GATEWAY_URL=${API_GATEWAY_URL:-http://api-gateway:3000}
AUTH_SERVICE_URL=${AUTH_SERVICE_URL:-http://auth-service:3001}
USER_SERVICE_URL=${USER_SERVICE_URL:-http://user-service:3002}
OPERATIONS_SERVICE_URL=${OPERATIONS_SERVICE_URL:-http://operations-service:3003}
INTELLIGENCE_SERVICE_URL=${INTELLIGENCE_SERVICE_URL:-http://intelligence-service:3004}
NOTIFICATIONS_SERVICE_URL=${NOTIFICATIONS_SERVICE_URL:-http://notifications-service:3005}
ANALYTICS_SERVICE_URL=${ANALYTICS_SERVICE_URL:-http://analytics-service:3006}
SEARCH_SERVICE_URL=${SEARCH_SERVICE_URL:-http://search-service:3007}

# ============================================
# LOGGING
# ============================================
LOG_LEVEL=info
LOG_FORMAT=json
LOG_REQUESTS=true
LOG_RESPONSE_TIME=true

# ============================================
# MONITORING
# ============================================
METRICS_ENABLED=true
METRICS_PORT=9090
HEALTH_CHECK_PATH=/health
SENTRY_DSN=${SENTRY_DSN:-}

# ============================================
# FEATURE FLAGS
# ============================================
ENABLE_MFA=true
ENABLE_OAUTH=true
ENABLE_API_KEYS=true
ENABLE_RATE_LIMITING=true
ENABLE_REQUEST_LOGGING=true

# ============================================
# NOTES
# ============================================
# 1. All secrets marked with :? are REQUIRED and must be set
# 2. Use a secret manager (Vault, AWS Secrets Manager, etc.) in production
# 3. Never commit actual secrets to version control
# 4. Rotate secrets regularly
# 5. Use strong, randomly generated values for all secrets
